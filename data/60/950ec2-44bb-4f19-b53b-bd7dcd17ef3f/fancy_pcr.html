<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>MBG PCR LIST</title>
<!-- 2015-05-05 周二 17:00 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Zhang Jing" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">MBG PCR LIST</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. zram/ksm</a>
<ul>
<li><a href="#sec-1-1">1.1. memory low after long time usage</a></li>
<li><a href="#sec-1-2">1.2. for android version above 4.2 and small dram devices</a></li>
<li><a href="#sec-1-3">1.3. ksm -&gt; 开机时配置扫描页数和频率，zram -&gt; 开机建立和挂载swap分区供压缩</a></li>
<li><a href="#sec-1-4">1.4. kernel/msm</a></li>
<li><a href="#sec-1-5">1.5. vendor/qcom/copper</a></li>
</ul>
</li>
<li><a href="#sec-2">2. boot: boot time</a>
<ul>
<li><a href="#sec-2-1">2.1. long boot time in normal boot</a></li>
<li><a href="#sec-2-2">2.2. multi-thread to scan package; increase GC threshold</a></li>
<li><a href="#sec-2-3">2.3. frameworks/base</a></li>
<li><a href="#sec-2-4">2.4. frameworks/native</a>
<ul>
<li><a href="#sec-2-4-1">2.4.1. <span class="todo TODO">TODO</span> change too much and different on L, not reviewed</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-3">3. touch: list view scroll too slow</a>
<ul>
<li><a href="#sec-3-1">3.1. 手指滑动相同距离，列表滚动距离短</a></li>
<li><a href="#sec-3-2">3.2. frameworks/base</a>
<ul>
<li><a href="#sec-3-2-1">3.2.1. <span class="todo TODO">TODO</span> need customize according to screen characteristics</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-4">4. app swith</a>
<ul>
<li><a href="#sec-4-1">4.1. ignore (app fix)</a></li>
</ul>
</li>
<li><a href="#sec-5">5. benchmark: antutu</a>
<ul>
<li><a href="#sec-5-1">5.1. cheat by cpu/gpu performance mode when detect benchmark app (improve benchmark by 1000-2500)</a></li>
<li><a href="#sec-5-2">5.2. hacking method</a></li>
<li><a href="#sec-5-3">5.3. frameworks/base</a></li>
<li><a href="#sec-5-4">5.4. <span class="todo TODO">TODO</span> qcom has add a common Performance api(perflock) in framework laywer in L</a></li>
</ul>
</li>
<li><a href="#sec-6">6. BT A2DP when suspend</a>
<ul>
<li><a href="#sec-6-1">6.1. 灭屏状态音乐卡顿</a></li>
<li><a href="#sec-6-2">6.2. 蓝牙耳机播放音乐，cpu在灭屏状态使用2 core, 音乐停止，让cpu恢复灭屏single core default setting.</a></li>
<li><a href="#sec-6-3">6.3. external/bluetooth/bluedroid</a></li>
<li><a href="#sec-6-4">6.4. system/core</a></li>
<li><a href="#sec-6-5">6.5. vendor/qcom-proprietary</a></li>
<li><a href="#sec-6-6">6.6. device/qcom/common</a></li>
</ul>
</li>
<li><a href="#sec-7">7. call app: incoming call response</a>
<ul>
<li><a href="#sec-7-1">7.1. 待机来电亮屏时间，提高响铃和页面显示的同步性</a></li>
<li><a href="#sec-7-2">7.2. 通话界面显示的逻辑优化，UI加载的时间优化，平衡来电铃音，亮屏速度与锁屏界面处理时机等，理论上缩短时间300-500ms.</a></li>
<li><a href="#sec-7-3">7.3. packages/apps/LenovoTeleservice</a></li>
</ul>
</li>
<li><a href="#sec-8">8. resume from suspend (screen light up)</a>
<ul>
<li><a href="#sec-8-1">8.1. 优化亮屏速度 （使用双MIPI DSI方案的平台）</a></li>
<li><a href="#sec-8-2">8.2. kernel/msm</a>
<ul>
<li><a href="#sec-8-2-1">8.2.1. <span class="todo TODO">TODO</span> arch/arm/boot/dts/msm8974-mdss.dtsi</a></li>
<li><a href="#sec-8-2-2">8.2.2. <span class="done DONE">DONE</span> drivers/video/msm/mdss/mdss_dsi.c</a></li>
<li><a href="#sec-8-2-3">8.2.3. <span class="done DONE">DONE</span> drivers/vidio/msm/mdss/mdss_dsi_panel.c</a></li>
<li><a href="#sec-8-2-4">8.2.4. <span class="todo TODO">TODO</span> drivers/video/msm/mdss/mdss_r63319.h</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-9">9. LMK</a>
<ul>
<li><a href="#sec-9-1">9.1. small free dram size (<b>procrank</b>)</a></li>
<li><a href="#sec-9-2">9.2. frameworks/native</a>
<ul>
<li><a href="#sec-9-2-1">9.2.1. <span class="done DONE">DONE</span> build/phone-xhdpi-1024-dalvik-heap.mk</a></li>
<li><a href="#sec-9-2-2">9.2.2. <span class="todo TODO">TODO</span> why include xhdpi-1024 not xhdpi-2048 for 3GB project(k9)?</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-10">10. broadcast slow</a>
<ul>
<li><a href="#sec-10-1">10.1. frameworks/base</a></li>
</ul>
</li>
<li><a href="#sec-11">11. broadcast slow</a></li>
<li><a href="#sec-12">12. volumn button hard to use</a></li>
<li><a href="#sec-13">13. boot up time in facotry mode (MTK only)</a></li>
<li><a href="#sec-14">14. app freeze and image tranfer fail in wechat</a>
<ul>
<li><a href="#sec-14-1">14.1. expand binder buffer size by 128KB</a></li>
<li><a href="#sec-14-2">14.2. frameworks/native</a></li>
</ul>
</li>
<li><a href="#sec-15">15. vmalloc fail</a>
<ul>
<li><a href="#sec-15-1">15.1. kernel/msm</a></li>
</ul>
</li>
<li><a href="#sec-16">16. boot up time GC</a>
<ul>
<li><a href="#sec-16-1">16.1. raise the preload GC threshold to avoid frequent GC</a></li>
<li><a href="#sec-16-2">16.2. frameworks/base</a></li>
</ul>
</li>
<li><a href="#sec-17">17. boost first time bootup with LOCAL_DEX_PREOPT</a>
<ul>
<li><a href="#sec-17-1">17.1. build</a></li>
</ul>
</li>
<li><a href="#sec-18">18. galary database update too slow after sd swap</a>
<ul>
<li><a href="#sec-18-1">18.1. 双sdcard, SD swap后，强制删除数据库，保证下次开机后快速更新media database, 保证galary, music快速访问数据库</a></li>
<li><a href="#sec-18-2">18.2. <span class="done DONE">DONE</span> device/lenovo/s7</a></li>
<li><a href="#sec-18-3">18.3. <span class="todo TODO">TODO</span> device/lenovo/8939_kk(testmode/jcommand.h)</a></li>
</ul>
</li>
<li><a href="#sec-19">19. EMMC NOSYNC mode: SQLITE_NO_SYNC (sqlite3.c)</a></li>
<li><a href="#sec-20">20. ATOMIC_WRITE mode (k900)</a>
<ul>
<li><a href="#sec-20-1">20.1. improve小数据写入性能(&lt;4KB)</a></li>
<li><a href="#sec-20-2">20.2. external/sqlite</a></li>
</ul>
</li>
<li><a href="#sec-21">21. adjust LMK adj for laucher to avoid kill when low memory</a>
<ul>
<li><a href="#sec-21-1">21.1. when a activity is launched, laucher is switched to BG activity, and maybe killed by LMK in system low memory condition</a></li>
<li><a href="#sec-21-2">21.2. frameworks/base</a></li>
</ul>
</li>
<li><a href="#sec-22">22. adjust long press time from 500ms to 350-400ms (ref 240ms)</a>
<ul>
<li><a href="#sec-22-1">22.1. frameworks/base</a></li>
</ul>
</li>
<li><a href="#sec-23">23. reduce settings  memory usage</a>
<ul>
<li><a href="#sec-23-1">23.1. settings app lauch slow</a></li>
<li><a href="#sec-23-2">23.2. packages/apps/Settings</a></li>
</ul>
</li>
<li><a href="#sec-24">24. key third party app optimize</a>
<ul>
<li><a href="#sec-24-1">24.1. 对常见未开启硬件加速app强制开启，保证帧率</a></li>
<li><a href="#sec-24-2">24.2. frameworks/base</a></li>
</ul>
</li>
<li><a href="#sec-25">25. boot app lauch by temporary change cpu sched policy</a>
<ul>
<li><a href="#sec-25-1">25.1. qcom change cpu policy to interactive and online core = 2, mtk plug on multi-core and keep for several seconds (need customization by project)</a></li>
<li><a href="#sec-25-2">25.2. <span class="todo TODO">TODO</span> kernel/msm</a></li>
<li><a href="#sec-25-3">25.3. <span class="todo TODO">TODO</span> frameworks/native</a></li>
<li><a href="#sec-25-4">25.4. <span class="todo TODO">TODO</span> frameworks/base</a></li>
</ul>
</li>
<li><a href="#sec-26">26. low power: adjust cpu sched policy to achieve balance of power and performance</a>
<ul>
<li><a href="#sec-26-1">26.1. CPU限频方案，针对不同场景制定合适的频率策略</a></li>
<li><a href="#sec-26-2">26.2. frameworks/base</a></li>
</ul>
</li>
<li><a href="#sec-27">27. touch false alarm in the edge, filter in touch driver</a>
<ul>
<li><a href="#sec-27-1">27.1. 窄边框边缘误触</a></li>
<li><a href="#sec-27-2">27.2. kernel/msm</a></li>
</ul>
</li>
<li><a href="#sec-28">28. 通话界面启动速度</a></li>
<li><a href="#sec-29">29. boost first time app lauch</a>
<ul>
<li><a href="#sec-29-1">29.1. frameworks/base</a></li>
</ul>
</li>
<li><a href="#sec-30">30. switch animation</a></li>
<li><a href="#sec-31">31. screen off gesture</a></li>
<li><a href="#sec-32">32. screen off camera</a></li>
<li><a href="#sec-33">33. linaro toolchain update</a>
<ul>
<li><a href="#sec-33-1">33.1. linux-arm-androideabi-4.8-linaro</a></li>
</ul>
</li>
<li><a href="#sec-34">34. qcom improve orientation change perf</a>
<ul>
<li><a href="#sec-34-1">34.1. kernel/msm</a></li>
</ul>
</li>
<li><a href="#sec-35">35. opengl parameter tuning</a>
<ul>
<li><a href="#sec-35-1">35.1. tuning</a></li>
<li><a href="#sec-35-2">35.2. frameworks/base</a></li>
</ul>
</li>
<li><a href="#sec-36">36. touch FW (landlock distance tuning)</a></li>
<li><a href="#sec-37">37. config zram size to balance perf/function</a></li>
<li><a href="#sec-38">38. DRAM turbo mode (risky)</a></li>
<li><a href="#sec-39">39. improve input event response by change cpu freq</a>
<ul>
<li><a href="#sec-39-1">39.1. cpu/gpu provile in certain context</a></li>
<li><a href="#sec-39-2">39.2. kernel/msm</a></li>
</ul>
</li>
<li><a href="#sec-40">40. neon in skia bionic memcpy</a></li>
<li><a href="#sec-41">41. [PCR-117]low power</a>
<ul>
<li><a href="#sec-41-1">41.1. push app list to devcie is possible</a></li>
<li><a href="#sec-41-2">41.2. frameworks/base</a></li>
</ul>
</li>
<li><a href="#sec-42">42. [PCR-118]non-linear backlight</a>
<ul>
<li><a href="#sec-42-1">42.1. kernel/msm</a></li>
</ul>
</li>
<li><a href="#sec-43">43. [PCR-120]boost camera lauch</a>
<ul>
<li><a href="#sec-43-1">43.1. kernel/msm</a></li>
</ul>
</li>
<li><a href="#sec-44">44. [PCR-123] cpu freq limit according to cpu thermal sensor</a>
<ul>
<li><a href="#sec-44-1">44.1. vendor/qcom-proprietary</a></li>
</ul>
</li>
<li><a href="#sec-45">45. [PCR-124] dalvik GC threshold</a></li>
<li><a href="#sec-46">46. [PCR-160] touch feedback</a>
<ul>
<li><a href="#sec-46-1">46.1. frameworks/base</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
<a href="http://work.lenovo.com/issue/browse/PCR">http://work.lenovo.com/issue/browse/PCR</a>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right">id</th>
<th scope="col" class="left">class</th>
<th scope="col" class="left">summary</th>
<th scope="col" class="left">platform</th>
<th scope="col" class="left">status</th>
<th scope="col" class="left">accept?</th>
<th scope="col" class="left">submit?</th>
<th scope="col" class="left">review</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">1</td>
<td class="left">dram size</td>
<td class="left">ZRAM/KSM</td>
<td class="left">8794</td>
<td class="left">valid</td>
<td class="left">TBD</td>
<td class="left">&#xa0;</td>
<td class="left">small dram size project</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">2</td>
<td class="left">boot time</td>
<td class="left">multi-thread to scan package; increase GC threshold</td>
<td class="left">mtk &amp; 8794</td>
<td class="left">valid</td>
<td class="left">Yes</td>
<td class="left">no</td>
<td class="left">verify on k9 ?</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">3</td>
<td class="left">perf</td>
<td class="left">app switch time with 空灵触控：fixed by app</td>
<td class="left">&#xa0;</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">app bug &amp; fixed, ignore</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">4</td>
<td class="left">touch</td>
<td class="left">list view scroll too short distance: SCROLL_FRICTION/TOUCH_SLOP</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">TBD</td>
<td class="left">&#xa0;</td>
<td class="left">customize according to sceen size and 阻尼系数</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">5</td>
<td class="left">benchmark</td>
<td class="left">Antutu: cheating by gpu/cpu performance mode when detect antutu</td>
<td class="left">mtk &amp; 8794</td>
<td class="left">valid</td>
<td class="left">TBD</td>
<td class="left">no</td>
<td class="left">qcom add new Performance interface in framework</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">6</td>
<td class="left">audio</td>
<td class="left">BT A2DP when suspend (adjust cpu schedule policy)</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">No</td>
<td class="left">no</td>
<td class="left">side effect on power, patch only if with same bug</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">7</td>
<td class="left">call</td>
<td class="left">incoming call</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">L call app may not suffer the problem</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">8</td>
<td class="left">suspend</td>
<td class="left">resume from suspend and light screen</td>
<td class="left">qcom</td>
<td class="left">valid</td>
<td class="left">Yes</td>
<td class="left">partial</td>
<td class="left">reduce delay in setup hw registers, and some dsi config?</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">9</td>
<td class="left">dram</td>
<td class="left">LMK parameter adjust</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">Yes</td>
<td class="left">yes</td>
<td class="left">12/256/512 used for k9</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">10</td>
<td class="left">boot</td>
<td class="left">broadcast slow at boot up time</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">google fix this problem,</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">11</td>
<td class="left">boot</td>
<td class="left">broadcast slow at boot up time (dup)</td>
<td class="left">common</td>
<td class="left">dup</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">12</td>
<td class="left">ui</td>
<td class="left">volumn button hard to use</td>
<td class="left">&#xa0;</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">not perf issue, ignore</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">13</td>
<td class="left">boot time</td>
<td class="left">factory mode boot up time : remove selinux(restorecon_xxx("/sys"")</td>
<td class="left">mtk only</td>
<td class="left">valid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">qcom do not need this</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">14</td>
<td class="left">app crash</td>
<td class="left">app freeze: expand default binder buffer size by 128KB</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">No</td>
<td class="left">no</td>
<td class="left">not merge if no failure</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">15</td>
<td class="left">dram</td>
<td class="left">adjust vmalloc threshold to avoid vmalloc fail</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">No</td>
<td class="left">no</td>
<td class="left">not merge if no vmalloc fail</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">16</td>
<td class="left">boot time</td>
<td class="left">raise the preload GC threshold to avoid frequent GC (dup)</td>
<td class="left">common</td>
<td class="left">dup</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">17</td>
<td class="left">boot time</td>
<td class="left">boost first time bootup with LOCAL_DEX_PREOPT (odex, user load)</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">TBD</td>
<td class="left">&#xa0;</td>
<td class="left">ART</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">18</td>
<td class="left">media</td>
<td class="left">galary database update too slow after sd swap</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">Yes</td>
<td class="left">partial</td>
<td class="left">jcommand to rm media dbs, retest with k9?</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">19</td>
<td class="left">database</td>
<td class="left">EMMC NOSYNC mode: SQLITE_NO_SYNC (sqlite3.c)</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">for poor emmc</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">20</td>
<td class="left">database</td>
<td class="left">ATOMIC_WRITE mode (k900)</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">Yes</td>
<td class="left">no</td>
<td class="left">merge after verify with k9</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">21</td>
<td class="left">launcher</td>
<td class="left">adjust LMK adj for laucher to avoid kill when low memory</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">useful for small memory devices</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">22</td>
<td class="left">touch</td>
<td class="left">adjust long press time from 500ms to 350-400ms (ref 240ms)</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">TBD</td>
<td class="left">&#xa0;</td>
<td class="left">behavior, not perf issue</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">23</td>
<td class="left">settings</td>
<td class="left">reduce settings  memory usage</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">for small memory devices</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">24</td>
<td class="left">3rd app</td>
<td class="left">improve key 3rd party app perf with HW_accel</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">check top 3rd party app default enable hw_accl</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">25</td>
<td class="left">app lauch</td>
<td class="left">temperary adjust cpu sched policy to boost app launch</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">Yes</td>
<td class="left">no</td>
<td class="left">merge after verify on k9</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">26</td>
<td class="left">low power</td>
<td class="left">adjust cpu sched policy (set cpu freq limit according to app list)</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">No</td>
<td class="left">no</td>
<td class="left">impact user experience, not recommend on high-end device</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">27</td>
<td class="left">touch</td>
<td class="left">false alarm in edge, touch driver filter</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">TBD</td>
<td class="left">&#xa0;</td>
<td class="left">not perf issue</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">28</td>
<td class="left">app</td>
<td class="left">calling app perf</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">implement in app, not perf issue</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">29</td>
<td class="left">app lauch</td>
<td class="left">[PCR-25]boost first time app lauch(no screenshot for home screen)</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">Yes</td>
<td class="left">no</td>
<td class="left">include in PCR-25</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">30</td>
<td class="left">animation</td>
<td class="left">switch animation</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">not perf issue</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">31</td>
<td class="left">gesture</td>
<td class="left">improve gesture performance in screen off mode</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">no code</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">32</td>
<td class="left">camera</td>
<td class="left">boost camera start up flow in screen off mode</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">no code</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">33</td>
<td class="left">toolchain</td>
<td class="left">gcc-4.8-linaro, -O2, neon-vfp4 (stability issue)</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">no code</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">34</td>
<td class="left">orientation</td>
<td class="left">qcom improve orientation change perf</td>
<td class="left">qcom</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">qcom driver include the patch</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">35</td>
<td class="left">display</td>
<td class="left">opengl tuning</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">Y</td>
<td class="left">no</td>
<td class="left">need customization</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">36</td>
<td class="left">touch</td>
<td class="left">touch FW (landlock distance tuning)</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">FW, not SW</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">37</td>
<td class="left">dram</td>
<td class="left">config zram size to balance perf/function</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">small memory devices only</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">38</td>
<td class="left">dram</td>
<td class="left">DRAM turbo mode (risky)</td>
<td class="left">common</td>
<td class="left">invalid</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">stability issue</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">39</td>
<td class="left">input</td>
<td class="left">improve input event response by change cpu freq</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">Yes</td>
<td class="left">&#xa0;</td>
<td class="left">qcom new Performance api support this ?</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">40</td>
<td class="left">perf</td>
<td class="left">neon in skia/bionic memcpy</td>
<td class="left">mtk</td>
<td class="left">valid</td>
<td class="left">Yes</td>
<td class="left">&#xa0;</td>
<td class="left">no code</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">117</td>
<td class="left">low power</td>
<td class="left">same as PCR-26</td>
<td class="left">common</td>
<td class="left">dup</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">118</td>
<td class="left">display</td>
<td class="left">non-linear backlight</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">TBD</td>
<td class="left">&#xa0;</td>
<td class="left">not perf issue</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">119</td>
<td class="left">low power</td>
<td class="left">same as PCR-26</td>
<td class="left">&#xa0;</td>
<td class="left">dup</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">120</td>
<td class="left">camera</td>
<td class="left">boost camera lauch</td>
<td class="left">qcom, mtk</td>
<td class="left">valid</td>
<td class="left">Yes</td>
<td class="left">yes</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">123</td>
<td class="left">low power</td>
<td class="left">limit cpu freq according to thermal</td>
<td class="left">qcom</td>
<td class="left">valid</td>
<td class="left">Yes</td>
<td class="left">no</td>
<td class="left">need verify on k9</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">124</td>
<td class="left">dalvik</td>
<td class="left">GC threshold</td>
<td class="left">mtk</td>
<td class="left">dup</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">no code</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">125</td>
<td class="left">wifi</td>
<td class="left">wifi RTS threshold 2347-&gt;2346</td>
<td class="left">common</td>
<td class="left">new</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">127</td>
<td class="left">wifi</td>
<td class="left">wifi ST enhance</td>
<td class="left">common</td>
<td class="left">new</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">133</td>
<td class="left">home</td>
<td class="left">return to home screen slow (reduce snapshot operation 2-&gt;1)</td>
<td class="left">common</td>
<td class="left">valid</td>
<td class="left">Yes</td>
<td class="left">no</td>
<td class="left">no code</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">141</td>
<td class="left">perf</td>
<td class="left">From PCR-10, a VIP broadcast channel</td>
<td class="left">&#xa0;</td>
<td class="left">dup</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">142</td>
<td class="left">display</td>
<td class="left">resume and display light up 600ms</td>
<td class="left">&#xa0;</td>
<td class="left">dup</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">143</td>
<td class="left">display</td>
<td class="left">PCR-8: resume and display light up (optimize to 300ms)</td>
<td class="left">&#xa0;</td>
<td class="left">dup</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">144</td>
<td class="left">perf</td>
<td class="left">PCR-14/15</td>
<td class="left">common</td>
<td class="left">dup</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">146</td>
<td class="left">wifi</td>
<td class="left">wifi signal strength</td>
<td class="left">&#xa0;</td>
<td class="left">new</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">147</td>
<td class="left">perf</td>
<td class="left">PCR-141</td>
<td class="left">&#xa0;</td>
<td class="left">new</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">154</td>
<td class="left">BT a2dp</td>
<td class="left">PCR-6</td>
<td class="left">&#xa0;</td>
<td class="left">dup</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">156</td>
<td class="left">display</td>
<td class="left">PCR-35</td>
<td class="left">&#xa0;</td>
<td class="left">dup</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">160</td>
<td class="left">touch</td>
<td class="left">touch feedback</td>
<td class="left">&#xa0;</td>
<td class="left">new</td>
<td class="left">N</td>
<td class="left">&#xa0;</td>
<td class="left">not perf issue</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="right">&#xa0;</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>


<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> zram/ksm</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> memory low after long time usage</h3>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> for android version above 4.2 and small dram devices</h3>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> ksm -&gt; 开机时配置扫描页数和频率，zram -&gt; 开机建立和挂载swap分区供压缩</h3>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> kernel/msm</h3>
<div class="outline-text-3" id="text-1-4">
<p>
arch/arm/configs/msm8974_defconfig
</p>
<div class="org-src-container">

<pre class="src src-sh">+CONFIG_SWAP=y
+CONFIG_ZRAM=y
+CONFIG_ZRAM_DEBUG=y
+CONFIG_ZSMALLOC=y
+CONFIG_KSM=y
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> vendor/qcom/copper</h3>
<div class="outline-text-3" id="text-1-5">
<p>
AndroidBoard.mk
</p>
<div class="org-src-container">

<pre class="src src-sh">+#include $(CLEAR_VARS)
+LOCAL_MODULE := fstab.zram
+LOCAL_MODULE_TAGS := optional
+LOCAL_MODULE_CLASS := ETC
+LOCAL_SRC_FILES := $(LOCAL_MODULE)
+LOCAL_MODULE_PATH := $(TARGET_ROOT_OUT)
+include $(BUILD_PREBUILT)
</pre>
</div>

<p>
fstab.zram
</p>
<div class="org-src-container">

<pre class="src src-sh">+/dev/block/zram0 none swap defaults zramsize=1073741824
</pre>
</div>

<p>
init.target.rc
</p>
<div class="org-src-container">

<pre class="src src-sh">on fs
 mount_all fstab.qcom
+swapon_all fstab.zram
+write /proc/sys/vm/swappiness 100
+write /sys/kernel/mm/ksm/pages_to_scan 100
+write /sys/kernel/mm/ksm/sleep_millisecs 500
+write /sys/kernel/mm/ksm/run 1
</pre>
</div>

<p>
msm8974.mk
</p>
<div class="org-src-container">

<pre class="src src-sh">+PRODUCT_PACKAGES += fstab.zram
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> boot: boot time</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> long boot time in normal boot</h3>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> multi-thread to scan package; increase GC threshold</h3>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> frameworks/base</h3>
<div class="outline-text-3" id="text-2-3">
<p>
core/java/com/android/internal/os/ZygoteInit.java
</p>
<div class="org-src-container">

<pre class="src src-java">-private static final int PRELOAD_GC_THRESHOLD = 50000;
+private static final int PRELOAD_GC_THRESHOLD = 500000;
</pre>
</div>

<p>
services/java/com/android/server/pm/Installer.java
</p>

<p>
services/java/com/android/server/pm/PackageManagerService.java
</p>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4"><span class="section-number-3">2.4</span> frameworks/native</h3>
<div class="outline-text-3" id="text-2-4">
<p>
cmds/installd/installd.c/.h
</p>
</div>

<div id="outline-container-sec-2-4-1" class="outline-4">
<h4 id="sec-2-4-1"><span class="section-number-4">2.4.1</span> <span class="todo TODO">TODO</span> change too much and different on L, not reviewed</h4>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> touch: list view scroll too slow</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> 手指滑动相同距离，列表滚动距离短</h3>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> frameworks/base</h3>
<div class="outline-text-3" id="text-3-2">
<p>
core/java/android/view/view/ViewConfiguration.java
</p>
<div class="org-src-container">

<pre class="src src-java">private static final int TOUCH_SLOP = 8 -&gt; 5;
private static final float SCROLL_FRICTION = 0.015f -&gt; 0x011f;
</pre>
</div>

<p>
core/res/res/values/config.xml
</p>
<div class="org-src-container">

<pre class="src src-xml">&lt;dimen name="config_viewConfigurationTouchSlop"&gt;8dp&lt;/dimen&gt; -&gt; 5dp
</pre>
</div>
</div>

<div id="outline-container-sec-3-2-1" class="outline-4">
<h4 id="sec-3-2-1"><span class="section-number-4">3.2.1</span> <span class="todo TODO">TODO</span> need customize according to screen characteristics</h4>
</div>
</div>
</div>


<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> app swith</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> ignore (app fix)</h3>
</div>
</div>


<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> benchmark: antutu</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> cheat by cpu/gpu performance mode when detect benchmark app (improve benchmark by 1000-2500)</h3>
</div>

<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> hacking method</h3>
<div class="outline-text-3" id="text-5-2">
<ul class="org-ul">
<li>activity 运行时检测包名，antutu-&gt;performance mode, activity 切后台/退出时，恢复。
</li>
<li>hotplug mode -&gt; performance mode
<ul class="org-ul">
<li>cpu governor set to performance
</li>
<li>disable DVFS
</li>
<li>all cpu plug on, high freq
</li>
<li>gpu loading_threshold 100%, freq (mali)
</li>
<li>disable thermal
</li>
</ul>
</li>
<li>performance mode -&gt; hotplug mode
<ul class="org-ul">
<li>cpu governor set to hotplug
</li>
<li>enable DVFS
</li>
<li>gpu loading_threshold 80%, freq(DVFS)
</li>
<li>enable thermal
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3"><span class="section-number-3">5.3</span> frameworks/base</h3>
<div class="outline-text-3" id="text-5-3">
<p>
services/java/com/android/server/am/ActivityManagerService.java
</p>
<div class="org-src-container">

<pre class="src src-java">private final void handleAppDiedLocked(Process Record app,
	boolean restarting, boolean allowRestart) {
+       if (null != app.info.packageName &amp;&amp; app.info.packageName.contains(mStackSupervisor.getPackageName())) {
		String str = mStackSupervisor.readSysFile(mStackSupervisor.mCpuFreqFilePath, '\0');
		if (!TextUtils.isEmpty(str) &amp;&amp; (str.trim().compareTo("41") == 0 ? true : false)) {
			mStackSupervisor.writeSysFile("0", mStackSupervisor.mCpuFreqFilePath);
			mStackSupervisor.mSetCpuFreqMark = 1;
		}
+       }
}
</pre>
</div>

<p>
services/java/com/android/server/am/ActivityStackSupervisor.java
</p>

<div class="org-src-container">

<pre class="src src-java">+package int mSetFreqMark = 1;
+String mCpuFreqFilePath = "/sys/devices/system/cpu/cpu0/rq-stats/mpctl";
+private int mPackageName[] = {0xc6, 0xde, 0xda, 0x5c, 0xc2, 0xdc, 0xe8, 0xea, 0xe8, 0xea};

final ActivityRecord acitvityIdleInternalLocked(final IBinder token, boolean from Timeout,
Configuration config) {
+       if (null != r.packageName) {
		if (r.packageName.contains(getPackageName())) {
			if (mSetCpuFreqMark != 0) {
				String str = readSysFile(mCpuFreqFilePath, '\0');
				if (!TextUtils.isEmpty(str) &amp;&amp; str.trim().compareTo("0") == 0 ? true : false))
					writeSysFile("41", mCpuFreqFilePath);
				mSetCpuFreqMark = 0;
		} else {
			if (mSetCpuFreqMark != 1) {
				String str = readSysFile(mCpuFreqFilePath, '\0');
				if (!TextUtils.isEmpty(str) &amp;&amp; str.trim().compareTo("41") == 0 ? true : false))
					writeSysFile("0", mCpuFreqFilePath);
				mSetCpuFreqMark = 0;
		}
+       }
}

void writeSysFile(String values, String filePath) {
...;
}

String readSysFile(String file, char endChar) {
...;
}

String getPackageName() {
...;
}
</pre>
</div>

<ul class="org-ul">
<li>sc.lenovo.com:8080/#/c/270787/
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4"><span class="section-number-3">5.4</span> <span class="todo TODO">TODO</span> qcom has add a common Performance api(perflock) in framework laywer in L</h3>
<div class="outline-text-3" id="text-5-4">
<p>
[ro.vendor.extension_library]: [libqti-perfd-client.so]
</p>

<p>
frameworks/base/core/res/res/values/config.xml
</p>

<div class="org-src-container">

<pre class="src src-xml">&lt;!-- Whether cpu boost is enabled for overscroller fling. --&gt;
&lt;bool name="config_enableCpuBoostForOverScrollerFling"&gt;false&lt;/bool&gt;
&lt;integer name="flingboost_timeout_param"&gt;0&lt;/integer&gt;
&lt;integer name="flingboost_schedboost_param"&gt;0&lt;/integer&gt;
&lt;integer name="flingboost_cpuboost_param"&gt;0&lt;/integer&gt;
&lt;integer name="flingboost_pcdisbl_param"&gt;0&lt;/integer&gt;
&lt;integer name="flingboost_ksmboost_param"&gt;0&lt;/integer&gt;

&lt;!-- Whether cpu boost is enabled for horizontal scroll. --&gt;
&lt;bool name="config_enableCpuBoostForScroller"&gt;false&lt;/bool&gt;
&lt;integer name="scrollboost_timeout_param"&gt;0&lt;/integer&gt;
&lt;integer name="scrollboost_schedboost_param"&gt;0&lt;/integer&gt;
&lt;integer name="scrollboost_cpuboost_param"&gt;0&lt;/integer&gt;
&lt;integer name="scrollboost_pcdisbl_param"&gt;0&lt;/integer&gt;
&lt;integer name="scrollboost_ksmboost_param"&gt;0&lt;/integer&gt;

&lt;!-- Configuration to enable non-default PDP during IWLAN --&gt;
&lt;bool name="config_feature_iwlan_enabled"&gt;false&lt;/bool&gt;
&lt;!-- set to false if we dont need to consider data
     service state to display signal strength bars --&gt;
&lt;bool name="config_combined_signal"&gt;true&lt;/bool&gt;

&lt;!-- Whether cpu boost is enabled for both application's 1st launch,subsequent
     launch and in-app-activity --&gt;
&lt;bool name="config_enableCpuBoostForAppLaunch"&gt;false&lt;/bool&gt;
&lt;integer name="launchboost_timeout_param"&gt;0&lt;/integer&gt;
&lt;integer name="launchboost_schedboost_param"&gt;0&lt;/integer&gt;
&lt;integer name="launchboost_cpuboost_param"&gt;0&lt;/integer&gt;
&lt;integer name="launchboost_cpu_6_7_offline_param"&gt;0&lt;/integer&gt;
&lt;integer name="launchboost_pcdisbl_param"&gt;0&lt;/integer&gt;
&lt;integer name="launchboost_ksmboost_param"&gt;0&lt;/integer&gt;
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> BT A2DP when suspend</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> 灭屏状态音乐卡顿</h3>
</div>

<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2"><span class="section-number-3">6.2</span> 蓝牙耳机播放音乐，cpu在灭屏状态使用2 core, 音乐停止，让cpu恢复灭屏single core default setting.</h3>
</div>

<div id="outline-container-sec-6-3" class="outline-3">
<h3 id="sec-6-3"><span class="section-number-3">6.3</span> external/bluetooth/bluedroid</h3>
<div class="outline-text-3" id="text-6-3">
<p>
audio_a2dp_hw/audio_a2dp_hw.c
</p>
<div class="org-src-container">

<pre class="src src-c">#define A2DP_CTRL_PROPERTY "audio.a2dp.status"

+static  void a2dp_cpu_ctrl(int stats)
{
	if (stats)
		property_set(A2DP_CTRL_PROPERTY, "play");
	else
		property_set(A2DP_CTRL_PROPERTY, "stop");
}

static int start_audio_datapathh(struct a2dp_stream_out *out)
{
+       a2dp_cpu_ctrl(true);
}

statuc int stop_audio_datapath(struct a2dp_stream_out *out)
{
+       a2dp_cpu_ctrl(false);
}
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6-4" class="outline-3">
<h3 id="sec-6-4"><span class="section-number-3">6.4</span> system/core</h3>
<div class="outline-text-3" id="text-6-4">
<p>
init/property_service.c
</p>
<div class="org-src-container">

<pre class="src src-c">+{ "audio.a2dp.", AID_MEDIA, 0},
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6-5" class="outline-3">
<h3 id="sec-6-5"><span class="section-number-3">6.5</span> vendor/qcom-proprietary</h3>
<div class="outline-text-3" id="text-6-5">
<p>
mpdecision/decision.c
</p>
<div class="org-src-container">

<pre class="src src-c">+static int display_on = 1;
+static int bt_play = 0;

int mpdecision_lock_min_cores(int min)
{
+       pthread_mutex_lock(&amp;hotplug_mutex);
	display_on = min &gt; 1 ? 1 : 0;
	if (!display_on &amp;&amp; bt_play) {
		pthread_mutex_unlock(&amp;hotplug_mutex);
		do_lock_min_cores(2);
	} else if (display_on &amp;&amp; lock_lock_min_cores == 2) {
		pthread_mutex_unlock(&amp;hotplug_mutex);
		do_lock_min_cores(1);
	} else
+               pthread_mutex_unlock(&amp;hotplug_mutex);
}

static void *do_perf_monitor(void *data)
{
-       int core_num = cmd / 10;
-       int governor = cmd % 10;
+       int core_num, governor;
	if (cmd &gt; 100) {
		bt_play = 2 - cmd / 100;
		cmd = cmd % 100;
	}
	core_num = cmd / 10;
+       governor = cmd % 10;

	if (core_num &gt; 0) {
		if (core_num &gt; num_cpus)
			core_num = num_cpus;
+               pthread_mutex_lock(&amp;hotplug_mutex);
		if (!display_on &amp;&amp; bt_play)
			if (core_num &lt; 2)
				core_num = 2;
		else if (display_on &amp;&amp; bt_play)
			core_num = 1;
+               pthread_mutex_lock(&amp;hotplug_mutex);
		do_lock_min_cores(core_num);
	}
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6-6" class="outline-3">
<h3 id="sec-6-6"><span class="section-number-3">6.6</span> device/qcom/common</h3>
<div class="outline-text-3" id="text-6-6">
<p>
rootdir/etc/init.qcom.rc
</p>
<div class="org-src-container">

<pre class="src src-sh">on property:audio.a2dp.status=play
	write /sys/devices/system/cpu/cpu0/rq-stats/mpctl 122

on property:audio.a2dp.status=stop
	write /sys/devices/system/cpu/cpu0/rq-stats/mpctl 212
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> call app: incoming call response</h2>
<div class="outline-text-2" id="text-7">
</div><div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1"><span class="section-number-3">7.1</span> 待机来电亮屏时间，提高响铃和页面显示的同步性</h3>
</div>

<div id="outline-container-sec-7-2" class="outline-3">
<h3 id="sec-7-2"><span class="section-number-3">7.2</span> 通话界面显示的逻辑优化，UI加载的时间优化，平衡来电铃音，亮屏速度与锁屏界面处理时机等，理论上缩短时间300-500ms.</h3>
</div>

<div id="outline-container-sec-7-3" class="outline-3">
<h3 id="sec-7-3"><span class="section-number-3">7.3</span> packages/apps/LenovoTeleservice</h3>
<div class="outline-text-3" id="text-7-3">
<p>
src/com/android/phone/CallController.java
</p>

<p>
src/com/android/phone/ErrorDialogActivity.java
src/com/android/phone/OutgoingCallBroadcaster.java
src/com/android/phone/PhoneUtils.java
src/com/android/phone/msim/MSimCallNotifier.java
</p>
</div>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> resume from suspend (screen light up)</h2>
<div class="outline-text-2" id="text-8">
</div><div id="outline-container-sec-8-1" class="outline-3">
<h3 id="sec-8-1"><span class="section-number-3">8.1</span> 优化亮屏速度 （使用双MIPI DSI方案的平台）</h3>
<div class="outline-text-3" id="text-8-1">
<p>
qcom原来的实现方式对每个DSI实现一次初始化，包含GPIO设置和延时，修改后，LCD reset和上电只做一次，延时也只做一次，节省LCD初始化时间。优化2K屏的DSI多通道多余操作，使得driver层的各项执行时间减少
</p>
</div>
</div>

<div id="outline-container-sec-8-2" class="outline-3">
<h3 id="sec-8-2"><span class="section-number-3">8.2</span> kernel/msm</h3>
<div class="outline-text-3" id="text-8-2">
</div><div id="outline-container-sec-8-2-1" class="outline-4">
<h4 id="sec-8-2-1"><span class="section-number-4">8.2.1</span> <span class="todo TODO">TODO</span> arch/arm/boot/dts/msm8974-mdss.dtsi</h4>
<div class="outline-text-4" id="text-8-2-1">
<div class="org-src-container">

<pre class="src src-sh">mdss_dsi0:qcom,mdss_dsi@fd922800 {
-       qcom,platform-supply-entry1;
	qcom,platform-supply-entry2;
	qcom,platform-supply-entry3;

-mdss_dsi1: qcom,mdss_dsi@fd922e00 {};
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-8-2-2" class="outline-4">
<h4 id="sec-8-2-2"><span class="section-number-4">8.2.2</span> <span class="done DONE">DONE</span> drivers/video/msm/mdss/mdss_dsi.c</h4>
<div class="outline-text-4" id="text-8-2-2">
<div class="org-src-container">

<pre class="src src-c">gpio_direction_output(ctrl_pdata-&gt;disp_vsp_gpio, 1);
- msleep(1);
+ udelay(100);
wmb();
gpio_direction_output(ctrl_pdata-&gt;disp_vsn_gpio, 1);
-sleep(20);
+msleep(4);
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-8-2-3" class="outline-4">
<h4 id="sec-8-2-3"><span class="section-number-4">8.2.3</span> <span class="done DONE">DONE</span> drivers/vidio/msm/mdss/mdss_dsi_panel.c</h4>
<div class="outline-text-4" id="text-8-2-3">
<div class="org-src-container">

<pre class="src src-c">- gpio_set_value((ctrl_pdata-&gt;rst_gpio), 1);
- msleep(20);
+ if(gpio_is_valid(ctrl_pdata-&gt;rst_gpio)) {
+       gpio_set_value((ctrl_pdata-&gt;rst_gpio), 1);
+       msleep(10);
+ }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-8-2-4" class="outline-4">
<h4 id="sec-8-2-4"><span class="section-number-4">8.2.4</span> <span class="todo TODO">TODO</span> drivers/video/msm/mdss/mdss_r63319.h</h4>
<div class="outline-text-4" id="text-8-2-4">
<div class="org-src-container">

<pre class="src src-c">static char ultra_mode_cmd0[] = {0x55, 0x73}; //old {0x55, 0x03}
static char ultra_mode_cmd1[] = {0xca, 0x01, 0x80, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0x20, 0x20 ...};
static char ultra_mode_cmd2[] = {0xba, 0x05, 0x3c, 0xff, 0x00, 0x00, 0x00};
static char ultra_mode_cmd3[] = {0xbd, 0x01, 0xb4, 0xa0};
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9"><span class="section-number-2">9</span> LMK</h2>
<div class="outline-text-2" id="text-9">
</div><div id="outline-container-sec-9-1" class="outline-3">
<h3 id="sec-9-1"><span class="section-number-3">9.1</span> small free dram size (<b>procrank</b>)</h3>
<div class="outline-text-3" id="text-9-1">
<p>
调整LMK参数，减少应用数量，提高内存回收threshold, 清理非前台应用
</p>
</div>
</div>
<div id="outline-container-sec-9-2" class="outline-3">
<h3 id="sec-9-2"><span class="section-number-3">9.2</span> frameworks/native</h3>
<div class="outline-text-3" id="text-9-2">
</div><div id="outline-container-sec-9-2-1" class="outline-4">
<h4 id="sec-9-2-1"><span class="section-number-4">9.2.1</span> <span class="done DONE">DONE</span> build/phone-xhdpi-1024-dalvik-heap.mk</h4>
<div class="outline-text-4" id="text-9-2-1">
<div class="org-src-container">

<pre class="src src-sh">dalvik.vm.heapgrowthlimit=192m # old is 96m
dalvik.vm.heapsize=512m # old is 256m
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-9-2-2" class="outline-4">
<h4 id="sec-9-2-2"><span class="section-number-4">9.2.2</span> <span class="todo TODO">TODO</span> why include xhdpi-1024 not xhdpi-2048 for 3GB project(k9)?</h4>
</div>
</div>
</div>

<div id="outline-container-sec-10" class="outline-2">
<h2 id="sec-10"><span class="section-number-2">10</span> broadcast slow</h2>
<div class="outline-text-2" id="text-10">
<p>
MTK建立单独的VIP broadcast queue，后来发现是android原生bug, 已经fix.
</p>
</div>

<div id="outline-container-sec-10-1" class="outline-3">
<h3 id="sec-10-1"><span class="section-number-3">10.1</span> frameworks/base</h3>
<div class="outline-text-3" id="text-10-1">
<p>
services/java/com/android/server/am/ActivityManagerService.java
</p>
</div>
</div>
</div>

<div id="outline-container-sec-11" class="outline-2">
<h2 id="sec-11"><span class="section-number-2">11</span> broadcast slow</h2>
</div>

<div id="outline-container-sec-12" class="outline-2">
<h2 id="sec-12"><span class="section-number-2">12</span> volumn button hard to use</h2>
</div>

<div id="outline-container-sec-13" class="outline-2">
<h2 id="sec-13"><span class="section-number-2">13</span> boot up time in facotry mode (MTK only)</h2>
</div>

<div id="outline-container-sec-14" class="outline-2">
<h2 id="sec-14"><span class="section-number-2">14</span> app freeze and image tranfer fail in wechat</h2>
<div class="outline-text-2" id="text-14">
</div><div id="outline-container-sec-14-1" class="outline-3">
<h3 id="sec-14-1"><span class="section-number-3">14.1</span> expand binder buffer size by 128KB</h3>
</div>

<div id="outline-container-sec-14-2" class="outline-3">
<h3 id="sec-14-2"><span class="section-number-3">14.2</span> frameworks/native</h3>
<div class="outline-text-3" id="text-14-2">
<p>
libs/binder/ProcessState.cpp
</p>
<div class="org-src-container">

<pre class="src src-cpp">+ #define BINGER_VM_SIZE ((1*1024*1024) - (4096 * 2) + (4096 * 32)) // ((1*1024*1024) - (4096 *2))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-15" class="outline-2">
<h2 id="sec-15"><span class="section-number-2">15</span> vmalloc fail</h2>
<div class="outline-text-2" id="text-15">
</div><div id="outline-container-sec-15-1" class="outline-3">
<h3 id="sec-15-1"><span class="section-number-3">15.1</span> kernel/msm</h3>
<div class="outline-text-3" id="text-15-1">
<p>
arch/arm/mm/mmu.c
</p>
<div class="org-src-container">

<pre class="src src-c">static void * __initdata vmalloc_min = (void *)(VMALLOC_END - (300 &lt;&lt; 20) - VMALLOC_OFFSET); // (VMALLOC_END - (240 &lt;&lt; 20) - VMALLOC_OFFSET)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-16" class="outline-2">
<h2 id="sec-16"><span class="section-number-2">16</span> boot up time GC</h2>
<div class="outline-text-2" id="text-16">
</div><div id="outline-container-sec-16-1" class="outline-3">
<h3 id="sec-16-1"><span class="section-number-3">16.1</span> raise the preload GC threshold to avoid frequent GC</h3>
</div>
<div id="outline-container-sec-16-2" class="outline-3">
<h3 id="sec-16-2"><span class="section-number-3">16.2</span> frameworks/base</h3>
<div class="outline-text-3" id="text-16-2">
<p>
core/java/com/android/internal/os/ZygoteInit.java
</p>
<div class="org-src-container">

<pre class="src src-java">private static final int PRELOAD_GC_THRESHOLD = 500000; //50000
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-17" class="outline-2">
<h2 id="sec-17"><span class="section-number-2">17</span> boost first time bootup with LOCAL_DEX_PREOPT</h2>
<div class="outline-text-2" id="text-17">
</div><div id="outline-container-sec-17-1" class="outline-3">
<h3 id="sec-17-1"><span class="section-number-3">17.1</span> build</h3>
<div class="outline-text-3" id="text-17-1">
<p>
core/prebuilt.mk
</p>
</div>
</div>
</div>

<div id="outline-container-sec-18" class="outline-2">
<h2 id="sec-18"><span class="section-number-2">18</span> galary database update too slow after sd swap</h2>
<div class="outline-text-2" id="text-18">
</div><div id="outline-container-sec-18-1" class="outline-3">
<h3 id="sec-18-1"><span class="section-number-3">18.1</span> 双sdcard, SD swap后，强制删除数据库，保证下次开机后快速更新media database, 保证galary, music快速访问数据库</h3>
<div class="outline-text-3" id="text-18-1">
<ul class="org-ul">
<li>jcommand
</li>
<li>init.rc
</li>
<li>在应用中deviceinfo/lenovousb/SwitchStoragePrefereceCategory.java clearDatabase()中call
<ul class="org-ul">
<li>SystemProperties.set("sys.jcommand_para", "[CLEAR_DATABASE]");
</li>
<li>SystemProperties.set("ctl.start", "jcommand");
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-18-2" class="outline-3">
<h3 id="sec-18-2"><span class="section-number-3">18.2</span> <span class="done DONE">DONE</span> device/lenovo/s7</h3>
<div class="outline-text-3" id="text-18-2">
<p>
init.lenovo.rc
</p>
<div class="org-src-container">

<pre class="src src-sh">+ service jcommand /system/bin/sh /system/bin/jcommand.sh
class main
disabled
oneshot
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-18-3" class="outline-3">
<h3 id="sec-18-3"><span class="section-number-3">18.3</span> <span class="todo TODO">TODO</span> device/lenovo/8939_kk(testmode/jcommand.h)</h3>
<div class="outline-text-3" id="text-18-3">
<div class="org-src-container">

<pre class="src src-sh">+function ClearDatabase() {
	echo "clear database"
	rm /data/data/com.android.providers.media/databases/external.db
	rm /data/data/com.android.providers.media/databases/external.db-shm
	rm /data/data/com.android.providers.media/databases/external.db-wal
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-19" class="outline-2">
<h2 id="sec-19"><span class="section-number-2">19</span> EMMC NOSYNC mode: SQLITE_NO_SYNC (sqlite3.c)</h2>
</div>

<div id="outline-container-sec-20" class="outline-2">
<h2 id="sec-20"><span class="section-number-2">20</span> ATOMIC_WRITE mode (k900)</h2>
<div class="outline-text-2" id="text-20">
</div><div id="outline-container-sec-20-1" class="outline-3">
<h3 id="sec-20-1"><span class="section-number-3">20.1</span> improve小数据写入性能(&lt;4KB)</h3>
<div class="outline-text-3" id="text-20-1">
<p>
sqlite benchmark, AndroBench, RL Benchmark, Acreve Benchmark
</p>
</div>
</div>

<div id="outline-container-sec-20-2" class="outline-3">
<h3 id="sec-20-2"><span class="section-number-3">20.2</span> external/sqlite</h3>
<div class="outline-text-3" id="text-20-2">
<p>
dist/Android.mk
</p>
<div class="org-src-container">

<pre class="src src-sh">+ -DSQLITE_ENABLE_ATOMIC_WRITE
</pre>
</div>

<p>
dist/sqlite3.c
</p>
<div class="org-src-container">

<pre class="src src-c">static int unixDeviceCharacteristics(sqlite3_file *id) {
	unixFile *p = (unixFile*)id;
-       if (p-&gt;ctrlFlags &amp; UNIXFILE_PSOW) {
		return SQLITE_IOCAP_POWERSAFE_OVERWRITE;
	} else {
		return 0;
-       }
+       int return Value = 0;
	if (p-&gt;ctrlFlags &amp; UNIXFILE_PSROW) {
		returnValue = SQLITE_IOCAP_POWERSAFE_OVERWRITE;
	}
	#ifdef SQLITE_ENABLE_ATOMIC_WRITE
	returnValue |= SQLITE_IOCAP_ATOMIC4K;
	#endif
+       return returnValue;
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-21" class="outline-2">
<h2 id="sec-21"><span class="section-number-2">21</span> adjust LMK adj for laucher to avoid kill when low memory</h2>
<div class="outline-text-2" id="text-21">
</div><div id="outline-container-sec-21-1" class="outline-3">
<h3 id="sec-21-1"><span class="section-number-3">21.1</span> when a activity is launched, laucher is switched to BG activity, and maybe killed by LMK in system low memory condition</h3>
<div class="outline-text-3" id="text-21-1">
<p>
dumpsys meminfo
</p>
</div>
</div>

<div id="outline-container-sec-21-2" class="outline-3">
<h3 id="sec-21-2"><span class="section-number-3">21.2</span> frameworks/base</h3>
<div class="outline-text-3" id="text-21-2">
<p>
services/java/com/android/server/am/ActivityManagerService.java
</p>
<div class="org-src-container">

<pre class="src src-java">private final int computeOomAdjLocked(ProessRecord app, int hiddenAdj, int clientHiddenAdj,
	int emptyAdj, ProcessRecord TOP_APP, boolean recursed, boolean doingAll) {

	if (app.processName.equals("android.process.media")) { };
+       if (app.processName.equals("android.process.acore")) {
		adj = ProcessList.FOREGROUND_APP_ADJ;
		schedGroup = Process.THREAD_GROUP_DEFAULT;
		app.adjType = "launcher";
+       }
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-22" class="outline-2">
<h2 id="sec-22"><span class="section-number-2">22</span> adjust long press time from 500ms to 350-400ms (ref 240ms)</h2>
<div class="outline-text-2" id="text-22">
</div><div id="outline-container-sec-22-1" class="outline-3">
<h3 id="sec-22-1"><span class="section-number-3">22.1</span> frameworks/base</h3>
<div class="outline-text-3" id="text-22-1">
<p>
core/java/android/view/ViewConfiguration.java
</p>
<div class="org-src-container">

<pre class="src src-java">private static final int DEFAULT_LONG_PRESS_TIMEOUT = 300; // 500
</pre>
</div>

<p>
packages/SettingsProvider/res/values/defaults.xml
</p>
<div class="org-src-container">

<pre class="src src-xml">&lt;integer name="def_long_press_timeout_millis"&gt;300&lt;/integer&gt; //500
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-23" class="outline-2">
<h2 id="sec-23"><span class="section-number-2">23</span> reduce settings  memory usage</h2>
<div class="outline-text-2" id="text-23">
</div><div id="outline-container-sec-23-1" class="outline-3">
<h3 id="sec-23-1"><span class="section-number-3">23.1</span> settings app lauch slow</h3>
<div class="outline-text-3" id="text-23-1">
<p>
开启系统过渡动画，优化初始化流程与界面布局，减少第一响应时间
(systrace)
</p>
</div>
</div>

<div id="outline-container-sec-23-2" class="outline-3">
<h3 id="sec-23-2"><span class="section-number-3">23.2</span> packages/apps/Settings</h3>
<div class="outline-text-3" id="text-23-2">
<p>
AndroidManifest.xml
</p>
<div class="org-src-container">

<pre class="src src-xml">&lt;activity android:name=".LenovoTabSettings"
-       android:theme="@android:style/Theme.DeviceDefault.Light.NoActionBar"
+       android:theme="@style/ThemeCustomactionBar"
</pre>
</div>

<p>
res/values/lenovo_style.xml
</p>
<div class="org-src-container">

<pre class="src src-xml">&lt;style name="CustomeActionBar" parent="@android:style/Widget.Holo.Light.ActionBar"&gt;
	&lt;item name="android:windowActionBarOverlay"&gt;true&lt;/item&gt;
	&lt;item name="android:displayOptions"&gt;showHome|useLogo&lt;/item&gt;
	&lt;item name="android:homeLayout"&gt;@layout/settings_tabs_pager&lt;/item&gt;
&lt;/style&gt;
</pre>
</div>

<p>
src/com/android/settings/AllSettings.java
</p>
<div class="org-src-container">

<pre class="src src-java">public void onResume() {
-       invalidateHeaders();
+       mHandler.sendEmptyMessageDelayed(REFRESH, 200);
}

+private static final int REFRESH = 1212;

private Handler mHandler = new Handler() {
	public void handleMessage(Message msg) {
		switch (msg.what) {
+               case REFRESH:
			invalidateHeaders();
+                       break;
		}
	}
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-24" class="outline-2">
<h2 id="sec-24"><span class="section-number-2">24</span> key third party app optimize</h2>
<div class="outline-text-2" id="text-24">
</div><div id="outline-container-sec-24-1" class="outline-3">
<h3 id="sec-24-1"><span class="section-number-3">24.1</span> 对常见未开启硬件加速app强制开启，保证帧率</h3>
<div class="outline-text-3" id="text-24-1">
<p>
(showfps)
</p>
</div>
</div>

<div id="outline-container-sec-24-2" class="outline-3">
<h3 id="sec-24-2"><span class="section-number-3">24.2</span> frameworks/base</h3>
<div class="outline-text-3" id="text-24-2">
<p>
core/java/android/content/pm/PackageParser.java
</p>
<div class="org-src-container">

<pre class="src src-java">+static final ArrayList&lt;String&gt; HWACCENAPPLIST = new ArrayList&lt;String&gt;();
static {
	HWACCENAPPLIST.add("com.sina.weibo");
	HWACCENAPPLIST.add("com.qzone");
+}

+for (int i = 0: i &lt; HWACCENAPPLIST.size(); i++) {
	if (owner.packageName.contains(HWACCENAPPLIST.get(i)))
		hardwareAccelerated = true;
+}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-25" class="outline-2">
<h2 id="sec-25"><span class="section-number-2">25</span> boot app lauch by temporary change cpu sched policy</h2>
<div class="outline-text-2" id="text-25">
</div><div id="outline-container-sec-25-1" class="outline-3">
<h3 id="sec-25-1"><span class="section-number-3">25.1</span> qcom change cpu policy to interactive and online core = 2, mtk plug on multi-core and keep for several seconds (need customization by project)</h3>
<div class="outline-text-3" id="text-25-1">
<p>
verify mini freq works after modification
</p>
<div class="org-src-container">

<pre class="src src-sh">cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
cat /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_max_freq
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-25-2" class="outline-3">
<h3 id="sec-25-2"><span class="section-number-3">25.2</span> <span class="todo TODO">TODO</span> kernel/msm</h3>
<div class="outline-text-3" id="text-25-2">
<p>
drivers/cpufreq/cpufreq_ondemand.c
</p>
<div class="org-src-container">

<pre class="src src-c">+ /* good touch experience */
#define LENOVO_CPU_INPUT_BOOST_HIGH_PERF
#ifdef LENOVO_CPU_INPUT_BOOST_HIGH_PERF
#define DEF_CPU_INPUT_BOOST_NUM (4)
#else
#define DEF_CPU_INPUT_BOOST_NUM (2)
#endif

+/* for input boost, 4 cores, highest cpu freq */
#ifdef LENOVO_CPU_INPUT_BOOST_HIGH_PERF
unsigned long next_jiffies = 0;
#define DVFS_F4 (300000)

static unsigned int cpu_num_base;
module_param(cpu_num_base, int, 0644);
#endif

static void do_dbs_timer(strut work_struct *work)
{
	mutex_lock(&amp;dbs_info-&gt;timer_mutex);
	/* for input boost, 4 core and highest cpu freq */
	#ifdef LENOVO_CPU_INPUT_BOOST_HIGH_PERF
	if (dbs_info-&gt;cur_policy-&gt;min == dbs_info-&gt;cur_policy-&gt;max
		&amp;&amp; next_jiffies == 0 &amp;&amp; 0 == cpu) {
		cpu_num_base = 4;
		next_jiffies = jiffies + msecs_to_jiffies(5000);
	}

	if (next_jiffies != 0 &amp;&amp; jiffies &gt; next_jiffies &amp;&amp; 0 == cpu) {
		next_jiffies = 0;
		dbs_info-&gt;cur_policy-&gt;min = (DVFS_F4);
		cpu_num_base = 1;
	} else if (next_jiffies != 0 &amp;&amp; jiffies &lt; next_jiffies)
		cpu_num_base = 4;
	#endif
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-25-3" class="outline-3">
<h3 id="sec-25-3"><span class="section-number-3">25.3</span> <span class="todo TODO">TODO</span> frameworks/native</h3>
<div class="outline-text-3" id="text-25-3">
<p>
services/surfaceflinger/SurfaceFlinger.cpp
</p>
<div class="org-src-container">

<pre class="src src-cpp">void SurfaceFlinger::computeVisibleRegions(
	const LayerVector&amp; currentLayers, uint32_t layerStack,
	Region&amp; outDirtyRegion, Region&amp; outOpaqueRegion)
{
	while (i--) {
	/* for main display: remove ext layer or background projector layer for all modes once mProjectableLayerVisibleOnMainDisplay is false */
-       if ((bIgnoreLayers &amp;&amp; indexLOI != (int)i) ||

+       if ((!dpy &amp;&amp; (!mProjectableLayerVisibleOnMainDisplay &amp;&amp; layr-&gt;isProjectorable())) ||
		/* for other display: remove project layer in mirror mode ONLY, and mProjectableLayerVisibleOnMainDisplay is false
+               (dpy &amp;&amp; !mDisplayExtensionMode &amp;&amp; !mProjectableLayerVisibleOnMainDisplay &amp;&amp; layer-&gt;isProjectorable()) ||
		/* for other display: remove internal layer; remove none projectable layers in ext mode */
-               (dpy &amp;&amp; mDisplayExtensionMode &amp;&amp; !layer-&gt;isProjectorable())) {
+               (dpy &amp;&amp; mDisplayExtensionMode &amp;&amp; !layer-&gt;isProjectorable() &amp;&amp; (strstr(layer-&gt;getName(), "Projectionapplication.VideoActivity") == NULL))) {
		/* ignore all other layers except the layers marked as ext_only by setting visible non transparent region empty */
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-25-4" class="outline-3">
<h3 id="sec-25-4"><span class="section-number-3">25.4</span> <span class="todo TODO">TODO</span> frameworks/base</h3>
<div class="outline-text-3" id="text-25-4">
<p>
services/java/com/android/server/am/ActivityStack.java
</p>
<div class="org-src-container">

<pre class="src src-java">final void startPausingLocked(boolean userLeaving, boolean uiSleeping) {
-       if (next == null || next.task != prev.task) {
/* do not screenshot when prev is home task */
+       if ((next == null || next.task != prev.task) &amp;&amp; !prev.task.isHomeTask()) {
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-26" class="outline-2">
<h2 id="sec-26"><span class="section-number-2">26</span> low power: adjust cpu sched policy to achieve balance of power and performance</h2>
<div class="outline-text-2" id="text-26">
</div><div id="outline-container-sec-26-1" class="outline-3">
<h3 id="sec-26-1"><span class="section-number-3">26.1</span> CPU限频方案，针对不同场景制定合适的频率策略</h3>
<div class="outline-text-3" id="text-26-1">
<ul class="org-ul">
<li>有功耗问题再考虑此solution
</li>
<li>根据名单，限制CPU最高频率，调整动态调频和多核管理策略，在性能损失可以忽略的前提下，达到功耗平衡点
</li>
<li>名单主要关注CPU负荷比较重的场景，按游戏，上网，视频，社交，导航等分类，根据乐商店TOP应用，做CPU频率优化
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-26-2" class="outline-3">
<h3 id="sec-26-2"><span class="section-number-3">26.2</span> frameworks/base</h3>
<div class="outline-text-3" id="text-26-2">
<p>
core/java/android/view/Choreographer.java
</p>
<div class="org-src-container">

<pre class="src src-java">+private static FrameDisplayEventReceiver mFakeDisplayEventReceiveer;

private Choreographer(Looper looper)
{
+       mFakeDisplayEventReceiver = mDisplayEventReceiver;
}

+public static void setVsyncType(int value) {
	mFakeDisplayEventReceiver.setVsyncType(value);
}
</pre>
</div>

<p>
core/java/android/view/DisplayEventReceiver.java
</p>
<div class="org-src-container">

<pre class="src src-java">+private static native void nativeSetVsyncType(int receiverPtr, int value);

/* FPS_60_30 */
+public void setVsyncType(int value) {
	if (mReceiverPtr != 0)
		nativeSetVsyncType(mReceiverPtr, value);
}
</pre>
</div>
<p>
core/jni/android_view_DisplayEventReceiver.cpp
</p>
<div class="org-src-container">

<pre class="src src-cpp">class NativeDisplayEventReceiver : public LooperCallback {
public:
+       status_t setVsyncType(int value);

+status_t NativeDisplayeventReceiver::setVsyncType(int value) {
	status_t status = mReceiver.setVsyncType(value);
	if( status)
		return status;
	return OK;
}
</pre>
</div>

<p>
services/java/com/android/server/am/ActivityStack.java
</p>
<div class="org-src-container">

<pre class="src src-java">private void completePauseLocked() {
+       Choreographer.setVsyncType(60);
}
</pre>
</div>

<p>
services/java/com/android/server/am/ActivityStackSupervisor.java
</p>
<div class="org-src-container">

<pre class="src src-java">+static Map&lt;String, Integer&gt; map = new HashMap&lt;String, Integer&gt;();
+static {
	map.put("com.lenovo.browser", 1728000);
	map.put("com.UCMobile.cmcc", 1728000);
	map.put("com.tencent.mm", 1728000);

	map.put("com.autonavi.cmccmap", 1267200);
...;
}

+private static final String LIMIT_CPU_LIST = "/data/list.txt";
+private static List&lt;String&gt; mCpuList = new ArrayList&lt;String&gt;();

-public void setFpsHashMap(boolean flag) {};
+public void setFpsHashMap() {
	mCpuList = splitFileIntoList(LIMIT_CPU_LIST);
	for (int i = 0; i &lt; mCpuList.size(); i++) {
		String str = mCpuList.get(i);
		String type = getLimitType(str);
		String pkg = getLimitPackageName(str);
		int freq = Integer.parseInt(getLimitFreq(str));
		if (type.equals("add"))
			map.put(pkg, freq);
		else if (type.equals("del"))
			map.remove(pkg);
	}
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-27" class="outline-2">
<h2 id="sec-27"><span class="section-number-2">27</span> touch false alarm in the edge, filter in touch driver</h2>
<div class="outline-text-2" id="text-27">
</div><div id="outline-container-sec-27-1" class="outline-3">
<h3 id="sec-27-1"><span class="section-number-3">27.1</span> 窄边框边缘误触</h3>
</div>

<div id="outline-container-sec-27-2" class="outline-3">
<h3 id="sec-27-2"><span class="section-number-3">27.2</span> kernel/msm</h3>
<div class="outline-text-3" id="text-27-2">
<p>
drivers/input/touchscreen/s3408/synaptics_dsx_i2c.c
</p>
<div class="org-src-container">

<pre class="src src-c">int X_DEL = 10; //0
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-28" class="outline-2">
<h2 id="sec-28"><span class="section-number-2">28</span> 通话界面启动速度</h2>
</div>

<div id="outline-container-sec-29" class="outline-2">
<h2 id="sec-29"><span class="section-number-2">29</span> boost first time app lauch</h2>
<div class="outline-text-2" id="text-29">
</div><div id="outline-container-sec-29-1" class="outline-3">
<h3 id="sec-29-1"><span class="section-number-3">29.1</span> frameworks/base</h3>
<div class="outline-text-3" id="text-29-1">
<p>
services/java/com/android/server/am/ActivityStack.java
</p>
<div class="org-src-container">

<pre class="src src-java">final void startPausingLocked(boolean userLeaving, boolean uiSleeping) {
-       if (next == null || next.task != prev.task) {
/* do not screenshot when prev is home task */
+       if ((next == null || next.task != prev.task) &amp;&amp; !prev.task.isHomeTask()) {
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-30" class="outline-2">
<h2 id="sec-30"><span class="section-number-2">30</span> switch animation</h2>
</div>

<div id="outline-container-sec-31" class="outline-2">
<h2 id="sec-31"><span class="section-number-2">31</span> screen off gesture</h2>
</div>

<div id="outline-container-sec-32" class="outline-2">
<h2 id="sec-32"><span class="section-number-2">32</span> screen off camera</h2>
</div>

<div id="outline-container-sec-33" class="outline-2">
<h2 id="sec-33"><span class="section-number-2">33</span> linaro toolchain update</h2>
<div class="outline-text-2" id="text-33">
</div><div id="outline-container-sec-33-1" class="outline-3">
<h3 id="sec-33-1"><span class="section-number-3">33.1</span> linux-arm-androideabi-4.8-linaro</h3>
<div class="outline-text-3" id="text-33-1">
<ul class="org-ul">
<li>thumb -O2 optimize
</li>
<li>mfpu neon-vfp4 (neon V2)
</li>
<li>makefile (toolchain and O2)
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-sec-34" class="outline-2">
<h2 id="sec-34"><span class="section-number-2">34</span> qcom improve orientation change perf</h2>
<div class="outline-text-2" id="text-34">
</div><div id="outline-container-sec-34-1" class="outline-3">
<h3 id="sec-34-1"><span class="section-number-3">34.1</span> kernel/msm</h3>
<div class="outline-text-3" id="text-34-1">
<p>
drivers/video/msm/mdss/mdss_fb.c
</p>

<p>
drivers/video/msm/mdss/mdss_fb.h
</p>

<p>
drivers/video/msm/mdss/mdss_mdp_intf_video.c
</p>

<p>
drivers/video/msm/mdss/mdss_mdp_overlay.c
</p>
</div>
</div>
</div>

<div id="outline-container-sec-35" class="outline-2">
<h2 id="sec-35"><span class="section-number-2">35</span> opengl parameter tuning</h2>
<div class="outline-text-2" id="text-35">
</div><div id="outline-container-sec-35-1" class="outline-3">
<h3 id="sec-35-1"><span class="section-number-3">35.1</span> tuning</h3>
<div class="outline-text-3" id="text-35-1">
<ul class="org-ul">
<li><a href="http://source.android.com/devices/tuning.html">http://source.android.com/devices/tuning.html</a>
</li>
<li><a href="http://pompidev.net/2013/09/20/opengl-texture-size-and-performance-texture-cache-androidios-gles-2/">http://pompidev.net/2013/09/20/opengl-texture-size-and-performance-texture-cache-androidios-gles-2/</a>, texture and cache size
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-35-2" class="outline-3">
<h3 id="sec-35-2"><span class="section-number-3">35.2</span> frameworks/base</h3>
<div class="outline-text-3" id="text-35-2">
<p>
libs/hwui/Properties.h
</p>
<div class="org-src-container">

<pre class="src src-c">#define DEFAULT_TEXTURE_CACHE_SIZE 72.0f //128.0f
#define DEFAULT_LAYER_CACHE_SIZE 48.0f //16.0f
#define DEFAULT_RENDER_BUFFER_CACHE_SIZE 8.0f //2.0f
#define DEFAUlT_PATH_CACHE_SIZE 40.0f //10.0f
#define DEFAULT_GRADIENT_CAHE_SIZE 1.0f //0.5f
#define DEFAULT_DROP_SHADOW_CACHE_SIZE 6.0f //2.0f
</pre>
</div>

<p>
libs/hwui/font/FontUtil.h
</p>
<div class="org-src-container">

<pre class="src src-c">#define DEFAULT_TEXT_SMALL_CACHE_HEIGHT 1024 //512
#define DEFAULT_TEXT_LARGE_CACHE_HEIGHT 1024 //512
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-36" class="outline-2">
<h2 id="sec-36"><span class="section-number-2">36</span> touch FW (landlock distance tuning)</h2>
</div>

<div id="outline-container-sec-37" class="outline-2">
<h2 id="sec-37"><span class="section-number-2">37</span> config zram size to balance perf/function</h2>
</div>

<div id="outline-container-sec-38" class="outline-2">
<h2 id="sec-38"><span class="section-number-2">38</span> DRAM turbo mode (risky)</h2>
</div>

<div id="outline-container-sec-39" class="outline-2">
<h2 id="sec-39"><span class="section-number-2">39</span> improve input event response by change cpu freq</h2>
<div class="outline-text-2" id="text-39">
</div><div id="outline-container-sec-39-1" class="outline-3">
<h3 id="sec-39-1"><span class="section-number-3">39.1</span> cpu/gpu provile in certain context</h3>
<div class="outline-text-3" id="text-39-1">
<ul class="org-ul">
<li>input 响应速度
</li>
<li>android powerhal
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-39-2" class="outline-3">
<h3 id="sec-39-2"><span class="section-number-3">39.2</span> kernel/msm</h3>
<div class="outline-text-3" id="text-39-2">
<p>
drivers/cpufreq/cpufreq-ondemand.c
</p>
<div class="org-src-container">

<pre class="src src-c">+static int hardkey_boost = 0;

static void do_dbs_timer(struct work_strut *work)
{
-       next_jiffies = jiffies + msecs_to_jiffies(5000);
+       if (hardkey_boost) {
		next_jiffies = jiffies;
		hardkey_boost = 0;
	} else
+               next_jiffies = jiffies + msecs_to_jiffies(5000);
}

static void dbs_input_event(struct input_handle *handle, unsigned int type
	unsigned int code, int value)
{
+       /* for input(hard key) boost 4 core, highest cpu freq */
	#ifdef LENOVO_CPU_INPUT_BOOST_HIGH_PERF
	if ((type == EV_KEY) &amp;&amp; value == 1 &amp;&amp; (KEY_MENU == code || KEY_HOMEPAGE == code || KEY_BACK == code)) {
		struct cpu_dbs_info_s *dbs_info = &amp;per_cpu(od_cpu_dbs_info, 0);
		dbs_info-&gt;cur_policy-&gt;min = dbs_info-&gt;cur_policy-&gt;max;
		hardkey_boost = 1;
	}
	#endif
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-40" class="outline-2">
<h2 id="sec-40"><span class="section-number-2">40</span> neon in skia bionic memcpy</h2>
</div>

<div id="outline-container-sec-41" class="outline-2">
<h2 id="sec-41"><span class="section-number-2">41</span> [PCR-117]low power</h2>
<div class="outline-text-2" id="text-41">
</div><div id="outline-container-sec-41-1" class="outline-3">
<h3 id="sec-41-1"><span class="section-number-3">41.1</span> push app list to devcie is possible</h3>
</div>

<div id="outline-container-sec-41-2" class="outline-3">
<h3 id="sec-41-2"><span class="section-number-3">41.2</span> frameworks/base</h3>
<div class="outline-text-3" id="text-41-2">
<p>
services/java/com/android/server/am/ActivityManagerService.java
</p>

<div class="org-src-container">

<pre class="src src-java">+       private HandlerThread mHandlerThread;
+       private PULimitHandler mCpuLimitHandler = null;


public void systemReady(final Runnable goingCallback) {
+       mHandlerThread = new HandlerThread("ScanCPULimitList");
	mHandlerThread.start(0;
	mCPULimitHandler = new CPUlimitHandler(mHandlerThread.getLooper());
	mCPULimitHandler.removeMessages(0);
	Message ScanBeginMsg = new Message();
	ScanBeginMsg.what = 0;
+       mCPULimitHandler.sendMessageDelayed(ScanBeginMsg, 60000);

}

+private final class CPULimitHandler extends Handler {
	public CPULimitHandler (Looper looper) {
		super(looper, null, true);
	}

	@Override
	public void handleMessage(Message msg) {
		switch(msg.whaat) {
		case 0:
			mStackSupervisor.setFpsHashMap();
			break;
		}
	}
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-42" class="outline-2">
<h2 id="sec-42"><span class="section-number-2">42</span> [PCR-118]non-linear backlight</h2>
<div class="outline-text-2" id="text-42">
</div><div id="outline-container-sec-42-1" class="outline-3">
<h3 id="sec-42-1"><span class="section-number-3">42.1</span> kernel/msm</h3>
<div class="outline-text-3" id="text-42-1">
<p>
drivers/video/msm/mdss/dss_dsi_panel.c
</p>

<div class="org-src-container">

<pre class="src src-c">static void mdss_dsi_panel_blkt_dcs(struct mdss_dsi_ctrl_pdata *ctrl, int level)
{
	if (level &gt;=0 &amp;&amp; level &lt;=10)
		real_level = (unsigned long)level;
	else if(level &lt;= 128 &amp;&amp; level &gt; 10)
		real_level = ((unsigned long)level*65 + 530)/118;
	else if (level &lt;=205 &amp;&amp; level &gt; 128)
		real_level = ((unsigned long)level*80 - 4465)/77;
	else if (level &lt;=255 &amp;&amp; level &gt; 205)
		real_level = (unsigned long)level*2 - 255;
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-43" class="outline-2">
<h2 id="sec-43"><span class="section-number-2">43</span> [PCR-120]boost camera lauch</h2>
<div class="outline-text-2" id="text-43">
</div><div id="outline-container-sec-43-1" class="outline-3">
<h3 id="sec-43-1"><span class="section-number-3">43.1</span> kernel/msm</h3>
<div class="outline-text-3" id="text-43-1">
<p>
arch/arm/boot/dts/msm8974-camera.dtsi
</p>
<div class="org-src-container">

<pre class="src src-c">&amp;master0 {
	qcom,hw-thigh = &lt;20&gt;; //78
	qcom,hw-tlow = &lt;28&gt;; //114
	qcom,hw-tsu-sto = &lt;6&gt;; //28
	qcom,hw-tsu-sta = &lt;7&gt;; //28
	qcom,hw-thd-dat = &lt;13&gt;; //10
	qcom,hw-thd-sta = &lt;11&gt;; //77
	qcom,hw-tbuf = &lt;25&gt;; //118
	qcom,hw-tsp = &lt;3&gt;; //1
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-44" class="outline-2">
<h2 id="sec-44"><span class="section-number-2">44</span> [PCR-123] cpu freq limit according to cpu thermal sensor</h2>
<div class="outline-text-2" id="text-44">
</div><div id="outline-container-sec-44-1" class="outline-3">
<h3 id="sec-44-1"><span class="section-number-3">44.1</span> vendor/qcom-proprietary</h3>
<div class="outline-text-3" id="text-44-1">
<p>
thermal-engine/ss-data.c
</p>
<div class="org-src-container">

<pre class="src src-c">static struct setting_info ss_cfgs_8974_pro_ac[] =
{
	{
		.set_point = 80000, //90000
	}
}
</pre>
</div>

<p>
thermal-engine/ss_algorithm.c
</p>
<pre class="example">
+static int handle_timer_done = 0;

static void handle_timer_sig(void)
{

+if(sampling_count &gt;= 20 &amp;&amp; !priv_control) {
	if (sampling_count &lt;= 60)
		fix_mitigation_lvl(&amp;algo_clnt[idx]);
	else
		sampling_count = 0;
	handle_timer_done = 1;
	continue;
+}
if (EO &lt; 0) {};
algo_clnt[idx].tc_delay = 0;
+handle_timer_done = 1;

static void *algo_monitor(void *data)
{
	while(1) {
		handle_timer_sig();
+		if (handle_timer_done) {
			handle_timer_done = 0;
			sampling_count++;
+		}
	}
}
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-45" class="outline-2">
<h2 id="sec-45"><span class="section-number-2">45</span> [PCR-124] dalvik GC threshold</h2>
</div>

<div id="outline-container-sec-46" class="outline-2">
<h2 id="sec-46"><span class="section-number-2">46</span> [PCR-160] touch feedback</h2>
<div class="outline-text-2" id="text-46">
</div><div id="outline-container-sec-46-1" class="outline-3">
<h3 id="sec-46-1"><span class="section-number-3">46.1</span> frameworks/base</h3>
<div class="outline-text-3" id="text-46-1">
<p>
policy/src/com/android/internal/policy/impl/PhoneWindowManager.java
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Zhang Jing</p>
<p class="date">Created: 2015-05-05 周二 17:00</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.4.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
